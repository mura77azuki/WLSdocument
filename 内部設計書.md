# 内部設計書
## 【詳細設計】
### 機能分割
#### アクセス制御
#### ルーティング
ミドルウェアでリファラーチェック  
静的ページは直接ビューに行く。  
動的ページにはコントローラーを割り当てする。  
全てのルートは名前付きルートとする。

#### バリデーション
formRequestで実装

#### コントローラー
画面グループ毎にコントローラーを作成。
各ページ名ルートと同じ名前でメソッドを作成。
各メソッドでページに必要な情報を集めてビューに渡す。

#### モデル
各テーブルに合わせて作成。
テーブル定義書に基づいてマイグレーションも作成。

#### ビュー
画面仕様書を元にbladeテンプレートを使って作る。

#### データ入出力

#### アカウント機能

#### 表示機能

#### 編集機能
|機能|操作|説明|
|---|---|---|  
|ON/OFF|左クリック|ドットのON/OFFを切り替える|

#### お問い合わせ機能

シーケンス図

---
## 【看板データ構造】
多バイト部分はビッグエンディアン  
0x12345678 = 12 34 56 78になる

### データ部の1bitずつの読み出し順
|bit位置|7|6|5|4|3|2|1|0|
|------|-|-|-|-|-|-|-|-|
|データの順番|0|1|2|3|4|5|6|7|

CRC32は将来実装用。今は全て0で埋める。

### データシグネチャ(仮)
|オフセット|バイト数|名称|内容|
|---|---|---|---|
|0x0000|8|signeture|"57 4C 45 44 53 49 47 4E"(WLEDSIGN)|
### ヘッダーチャンク
|オフセット|バイト数|名称|内容|
|---|---|---|---|
|0x0000|4|length|チャンクのサイズ(常に9)|
|0x0004|4|chank type|"48 45 41 44"ASCIIで"HEAD"|
|0x0008|4|width|横のドット数|
|0x000C|4|height|縦のドット数|
|0x0010|1|color_type|1:単色,2:2~3色,4:4色以上|
|0x0014|4|CRC|巡回冗長検査|
### データチャンク
|オフセット|バイト数|名称|内容|
|---|---|---|---|
|0x0000|4|length|チャンクのサイズ|
|0x0004|4|chank type|"44 41 54 41"ASCIIで"DATA"|
|0x0008|n|data|実際のデータ|
|0xXXXX|4|CRC|巡回冗長検査|
### 終端チャンク
|オフセット|バイト数|名称|内容|
|---|---|---|---|
|0x0000|4|length|チャンクのサイズ(常に0)|
|0x0004|4|chank type|"44 45 4E 44"ASCIIで"DEND"|
|0x0008|4|CRC|巡回冗長検査|


データ構造定義

-ファイル識別プレフィクス
-HEADER部: 識別用4文字
--size: 1byte ヘッダーのサイズ
--width: 4byte 表示データの幅（ドット数）
--height: 4byte 表示データの高さ(ドット数)
--color_set: 1byte 色の表現方法(単色,複数色,カラーパレット,フルカラー)
--compression algorithm: 1byte 圧縮方法
--animetion method: 1byte アニメーション方式

-COLOR_PALETTE部: 識別用4文字
--size: 1byte カラーパレットのサイズ
--color_num: *byte 色数

-DATA START部: 識別用4文字
--size: *byte データサイズ
--data: 実際のデータ
-DATA END部: 識別用4文字

以降のデータは無視される